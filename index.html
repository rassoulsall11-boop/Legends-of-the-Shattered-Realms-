<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEON VORTEX - ARCADE</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&display=swap');
        :root { --primary: #00f3ff; --secondary: #ff0055; --bg: #050505; }
        * { box-sizing: border-box; user-select: none; touch-action: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: var(--bg); font-family: 'Orbitron', sans-serif; color: white; }
        canvas { display: block; position: absolute; top: 0; left: 0; }
        
        .overlay { position: absolute; inset: 0; background: rgba(5,5,5,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; text-align: center; }
        .hidden { display: none !important; }
        
        h1 { font-size: 2.5rem; background: linear-gradient(to right, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; filter: drop-shadow(0 0 10px rgba(0, 243, 255, 0.5)); }
        
        button { padding: 18px 40px; font-family: 'Orbitron'; font-weight: 900; background: var(--primary); border: none; cursor: pointer; color: #000; clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%); font-size: 1.1rem; }
        
        .stats { margin-top: 25px; padding: 15px; border-top: 1px solid #333; width: 200px; }
        .best-label { color: var(--secondary); font-size: 0.8rem; letter-spacing: 2px; }
        .best-score { font-size: 1.5rem; color: #fff; display: block; }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="menuScreen" class="overlay">
    <h1>NEON VORTEX</h1>
    <button id="startBtn">START MISSION</button>
    <div class="stats">
        <span class="best-label">RECORD PERSONNEL</span>
        <span id="bestScoreDisplay" class="best-score">0</span>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const menuScreen = document.getElementById('menuScreen');
    const startBtn = document.getElementById('startBtn');
    const bestDisplay = document.getElementById('bestScoreDisplay');

    let state = 'MENU';
    let score = 0;
    // On récupère le record enregistré dans le téléphone
    let highscore = localStorage.getItem('neonVortex_highscore') || 0;
    bestDisplay.innerText = Math.floor(highscore);

    let player = { x: 0, y: 0, tx: 0, ty: 0, r: 12 };
    let enemies = [];

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    // Contrôles tactiles et souris
    const handleMove = (e) => {
        const t = e.touches ? e.touches[0] : e;
        player.tx = t.clientX;
        player.ty = t.clientY;
    };
    window.addEventListener('mousemove', handleMove);
    window.addEventListener('touchmove', handleMove);

    startBtn.onclick = () => {
        state = 'PLAY';
        score = 0;
        enemies = [];
        player.x = player.tx = canvas.width / 2;
        player.y = player.ty = canvas.height / 2;
        menuScreen.classList.add('hidden');
    };

    function spawnEnemy() {
        enemies.push({
            x: Math.random() * canvas.width,
            y: -50,
            w: 20 + Math.random() * 20,
            h: 20 + Math.random() * 20,
            speed: 5 + Math.random() * 5 + (score / 100) // La vitesse augmente avec le score
        });
    }

    function loop() {
        // Fond noir profond
        ctx.fillStyle = '#050505';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (state === 'PLAY') {
            score += 0.2;

            // Déplacement fluide
            player.x += (player.tx - player.x) * 0.15;
            player.y += (player.ty - player.y) * 0.15;

            // Dessin du joueur avec halo néon
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#00f3ff';
            ctx.fillStyle = '#00f3ff';
            ctx.beginPath();
            ctx.arc(player.x, player.y, player.r, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;

            // Gestion des ennemis
            if (Math.random() < 0.08) spawnEnemy();

            for (let i = enemies.length - 1; i >= 0; i--) {
                let e = enemies[i];
                e.y += e.speed;

                // Dessin ennemi
                ctx.fillStyle = '#ff0055';
                ctx.fillRect(e.x, e.y, e.w, e.h);

                // Collision (Hitbox simplifiée)
                if (player.x + player.r > e.x && 
                    player.x - player.r < e.x + e.w && 
                    player.y + player.r > e.y && 
                    player.y - player.r < e.y + e.h) {
                    
                    gameOver();
                }

                // Supprimer si hors écran
                if (e.y > canvas.height) enemies.splice(i, 1);
            }

            // Score en haut à gauche
            ctx.fillStyle = 'white';
            ctx.font = '900 20px Orbitron';
            ctx.fillText(Math.floor(score), 25, 40);
        }
        requestAnimationFrame(loop);
    }

    function gameOver() {
        state = 'MENU';
        if (score > highscore) {
            highscore = score;
            localStorage.setItem('neonVortex_highscore', highscore);
        }
        bestDisplay.innerText = Math.floor(highscore);
        menuScreen.classList.remove('hidden');
    }

    loop();
</script>
</body>
</html>
